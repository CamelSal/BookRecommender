# Book Recommender

This repository contains the code and documentation for a book recommender system part of capstone project for BrainStation


## Overview

### Problem Statement:

In today's world, with an ever-increasing number of books being published, discovering books that genuinely align with one's interests has become challenging. The abundance of available books and vague categorizations often makes finding an enjoyable read a truly frustrating experience.

### Those Affected:
As an avid reader, I've personally grappled with this issue. Readers, both casual and dedicated, encounter this problem. The moment you finish a book you enjoyed, you're left searching for something similar, often with no clear starting point, leaving readers in a state of ambiguity. This is an issue that resonates with anyone who's ever embarked on the quest for their next great read.


### Business Values:

A reliable book recommender has the potential to increase readers' consumption rate significantly. It can be a game-changer, reducing the time spent hunting for new books and ensuring they discover more engaging and enjoyable reads. Moreover, it's not just readers who stand to benefit from this innovation. Businesses have a vested interest in this as well, as it can enhance the shopping frequency of their customers, ultimately leading to higher sales and fostering customer loyalty.

### Proposed Data Science Solution:

This project addresses the issue by developing an intelligent book recommendation system. The primary aim is to seamlessly connect readers with books that align with their tastes, simplifying the process of finding enjoyable reads amidst the vast sea of available options.

To achieve this, the project harnesses the power of machine learning. The book recommender system will employ various techniques, including both content-based and collaborative filtering, resulting in a hybrid recommender. The implementation will involve exploring algorithms such as Singular Value Decomposition (SVD) and Cosine Similarity. These algorithms are instrumental in identifying similar users and making predictions about user ratings for book recommendations. This combination ensures a robust and effective recommendation system for book enthusiasts.

![alt text](https://github.com/CamelSal/BookRecommender/blob/main/images/image1.png?raw=true)

## Project Composition
 This project comprises three Jupyter Notebooks, Python code for a Streamlit app, and some supplementary files.

 1. **Data_Cleaning_Exploratio.ipynb**: This notebook covers all aspects of data cleaning and initial exploration of the GoodBooks-10K Dataset.

 2. **Funk_SVD_Modeling.ipynb**: This notebook containes my initial modelling of the user ratings data with the the Funk Single Value Decomposition model follows by the fine tuning of is hyper parameters.

 3. **Hybrid_Recomender.ipynb**: Utilizing findings from the previous notebooks, this notebook creates different similarity arrays and builds a function to combine them into a hybrid recommender. The final results are saved for use in the demo.

 4. **Streamlit**:  This directory contains Python code that runs a Streamlit app to execute the recommendations file, along with two CSV files containing recommendations generated by the last notebook.

## Dataset

For this project will be working with the data [GoodBooks-10K](https://github.com/zygmuntz/goodbooks-10k) and [GoodBooks-10k-Extended](https://github.com/malcolmosh/goodbooks-10k-extended) which combine contain four indidual files that will be utilized to build the book recommender system.

#### books.csv: A dataset with 10,000 unique books from Goodreads.

| Column                     | Type    | Description                                            |
|-----------------------------|---------|--------------------------------------------------------|
| book_id                    | int64  | Unique ID for each book                                |
| goodreads_book_id          | int64  | Unique ID for the most popular edition of each book from the Goodreads website |
| best_book_id               | int64  | Best book ID                                          |
| work_id                    | int64  | Unique ID for the aggregation of all editions of each book from the Goodreads website |
| books_count                | int64  | Number of editions for each book                       |
| authors                    | object  | The names of all the authors                            |
| original_publication_year  | float64  | The year the original book was published                |
| title                      | object  | The title of the book                                   |
| average_rating             | float64  | The average rating across all editions of the book      |
| ratings_count              | int64  | The total number of ratings for all editions of the book |
| work_ratings_count         | int64  | The total number of user ratings for all editions of the book |
| work_text_reviews_count    | int64  | The total number of text reviews for all editions of the book |
| ratings_1                  | int64  | The number of 1-star ratings for all editions of the book |
| ratings_2                  | int64  | The number of 2-star ratings for all editions of the book |
| ratings_3                  | int64  | The number of 3-star ratings for all editions of the book |
| ratings_4                  | int64  | The number of 4-star ratings for all editions of the book |
| ratings_5                  | int64  | The number of 5-star ratings for all editions of the book |
| image_url                  | object  | URL of the book's cover image                          |
| language_code              | object  | Abbreviated language tag                                |
| genres                     | object  | Genres associated with the book  

#### ratings.csv: Contains 5.97 million user ratings for the books.

| Column     | Type    | Description    |
|-------------------|-------------------|-------------------|
| user_id   | int64  | Unique ID for each user  |
| book_id	   | int64  | Unique ID for each book |
| rating   | int64  | Rating from 1 to 5  |


#### book_tags.csv: the tags Assigned by users to books and their counts

| Column     | Type    | Description    |
|-------------------|-------------------|-------------------|
| goodreads_book_id  | int64  | Unique ID for each book from the GoodReads Website |
| tag_id  | int64 | Unique ID for each tag  |
| count   | int64  | The number of users that have assigned the tag  |

#### tags.csv: All user-generated tags id and their names

| Column     | Type    | Description    |
|-------------------|-------------------|-------------------|
| tag_id   | int64  | Unique ID for each tag   |
| tag_name  | object  | Name of the tag  |



## Project Organization

### Data Collection and Preprocessing
1. **Gather Data**: Collect data from GoodBooks-10K. 

2. **Clean Data**: Addressed missing values by filling in the gaps for the publication year and language code and eliminated redundant columns such as ISBN and Original Title. In addition, six duplicated rows were removed from the Book Tags dataset.


### Exploratory Data Analysis

3. **Data Visualization**: Create visualizations to explore the dataset, examining the distribution of publication years, the distribution of the number of tags per book, and the distribution of the number of books rated by each user.

![alt text](https://github.com/CamelSal/BookRecommender/blob/main/images/ratings_dis.png?raw=true)

4. **Identify Data Patterns**: Identified that the ratings exhibited a good amount of spread between users and books, making them ready for modelling. In contrast, the tags required some feature engineering, as over half of the tags were present in only one book.

![alt text](https://github.com/CamelSal/BookRecommender/blob/main/images/books_dis.png?raw=true)

### Feature Engineering

5. **Refine Data** Refine the book tag data by eliminating tags that appeared in fewer than 10 books or were present in more than 66% of the books, resulting in approximately 5,000 tags. Most books now have around 60-80 tags each

![alt text](https://github.com/CamelSal/BookRecommender/blob/main/images/num_tags.png?raw=true)

6. **Trasformed Tag Count**  I transformed the count of each tag for each specific book by dividing it by the maximum count each book received, normalizing the data for all books to facilitate easy comparison.

###  Collaborative Filtering Model Building

7. **Baseline Model**: The Funk Singular Value Decomposition (SVD) model for collaborative filtering was implemented. Using the ratings dataset, a sample of 200k ratings was taken, and RMSE, MAE, and FCP metrics were used to evaluate its performance.

8. **Tune Hyperparameters** Using the small sampled data, the hyperparameters, including n_factors, epochs, and learning rate, were tuned. This was accomplished using a five-fold cross-validation approach to evaluate the performance of different parameter combinations.

9. **Integrate Large Dataset** Incorporated the larger dataset, representing 80% of the original data, to further fine-tune the hyperparameters, particularly focusing on optimizing 'n_factors' for the Funk SVD model.

10. **Latent Book Factors** Ran the Funk SVD model with the hyper-tuned parameters (best parameters: n_factors 20, epochs 20, learning rate 0.0075 and biased False) and extracted the latent factors of the books to perform a cosine similarity comparison for each book.

11. **First Recommender** Made a function to generate the initial book recommendations by utilizing the latent factors to identify the top 10 similar books for a given book.

### Content-Based Filtering Model Building

12. **Token Genres** Utilized CountVectorizer with a custom token to extract the individual genres included in each book and employed cosine similarity to compare them. 

13. **First Content Recomendations** Generated the initial content recommendations, although for many books, there were multiple entries with perfect similarity scores.

14. **Scaled Data** Employed StandardScaler to scale the tag data and conducted cosine similarity comparisons for each book, enhancing the precision of content-based recommendations.

15. **Second Content Recomendations** Generated the second set of content recommendations using tags, offering more diverse results. Similarity scores among the top recommendations appear to be more varied compared to other recommenders.

### Hybrid Filtering Model Combining

16. **Combine Results** Combined the scores of all three recommendation systems to produce the combined results of the top 10 recommendations.

17. **Tune Weight** Tuned the weight of each recommender and added the average rating to the mix, allowing for optimal results.

![alt text](https://github.com/CamelSal/BookRecommender/blob/main/images/score_fn.png?raw=true)

18. **Author Filter** Created the option to exclude books by the same author from recommendations.

19. **Final Results** Uploaded the final recomendation results for both author options of all books to csv file to be used in a demo 



### Steamlit Demo
20. **Interactive Showcase** Developed an interactive and user-friendly demo of the book recommender system, allowing users to explore and experience the recommendations firsthand.

![alt text](https://github.com/CamelSal/BookRecommender/blob/main/images/demo_prw.png?raw=true)


##  Findings & Conclusion 

After this extensive journey, from initially acquiring and cleaning the book data to the modeling and building of the recommender, we were able to achieve the project's primary goal of creating an intelligent and effective system for recommending books to users. This was accomplished by leveraging various data science techniques and machine learning to create a hybrid book recommender. This hybrid system identifies similar books not only based on content but also on user ratings, providing smarter book recommendations that have the capacity to revolutionize the way readers discover and enjoy books. This contributes to a more satisfying and efficient reading experience.

In the course of this project, several key findings highlight the success and effectiveness of our approach:

- **Normalized Tag Data** Adjusted the book tag count to better represent the data, eliminating outliers with too little or too much representation. Normalized the data to ensure all books have the same range, contributing to a more accurate and reliable content-based filtering system.

- **Effective Hyperparameter Tuning:** The fine-tuning of hyperparameters to enhance the performance of the Funk SVD model, initially explored with a small dataset and further refined with a larger dataset, revealed that certain hyperparameters have different optimal values with more data.

- **Hybrid Approach Success:** The combination of collaborative filtering and content-based filtering and weighting their scores has proven to be a successful strategy. Leveraging the strengths of each approach has resulted in more accurate and diverse book recommendations.

- **Interactive Showcase:** The integration of a Streamlit app provides an interactive and user-friendly platform for users to explore and experience the book recommendations firsthand.

This Hybrid Book Recommender project holds the potential to transform how readers engage with books, providing a novel and more personalized reading experience